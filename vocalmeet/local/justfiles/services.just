# =============================================================================
# Service Management Commands
# =============================================================================

# Build WordPress image (with Xdebug)
build:
    @echo "ğŸ”¨ Building WordPress image with Xdebug..."
    {{compose}} build wordpress
    @echo "âœ… Build complete!"

# Start all services
start:
    @echo "ğŸš€ Starting WordPress environment..."
    {{compose}} up -d mysql nginx wordpress phpmyadmin
    @echo ""
    @echo "âœ… Services started!"
    @echo "   WordPress:   {{wordpress_url}}"
    @echo "   phpMyAdmin:  {{phpmyadmin_url}}"

# Stop all services (keeps data)
stop:
    @echo "ğŸ›‘ Stopping services..."
    {{compose}} stop

# Stop and remove all containers (keeps volumes/data)
down:
    @echo "ğŸ›‘ Stopping and removing containers..."
    {{compose}} down

# Stop, remove containers AND delete all data
clean:
    @echo "ğŸ—‘ï¸  Removing everything including data..."
    {{compose}} down -v
    @echo "âœ… All containers and volumes removed"

# Restart all services
restart: stop start

# Show status of all services
status:
    {{compose}} ps

# Initial setup: build image + generate SSL + start services + install plugins
setup: build ssl-generate
    @echo "ğŸš€ Starting WordPress environment..."
    {{compose}} up -d mysql nginx wordpress phpmyadmin
    @echo "â³ Waiting for WordPress to be ready..."
    @sleep 30
    @echo "ğŸ“¦ Installing required plugins..."
    just wp plugin install elementor --activate
    just wp plugin install woocommerce --activate
    @echo ""
    @echo "âœ… Setup complete!"
    @echo "   WordPress:   {{wordpress_url}}"
    @echo "   phpMyAdmin:  {{phpmyadmin_url}}"
    @echo ""
    @echo "âš ï¸  Note: Accept the self-signed certificate warning in your browser"
    @echo "ğŸ“ WordPress source: vocalmeet/assessment/wordpress/"
    @echo "ğŸ› Xdebug enabled on port 9003"
